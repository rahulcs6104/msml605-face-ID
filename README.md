# MSML 605 — Face Verification (Milestone 1)

Contributors: Rahul · Akshaaj

## Repo Structure
```

msml605-face-verification/
├── README.md
├── requirements.txt          # has all the dependencies
├── .gitignore                # has all the folders not be be pushed to github
├── configs/
│   └── m1.yaml               # has the seed, split ratios, pair counts, paths
├── src/
│   ├── __init__.py           # This makes src importable in other files
│   ├── ingestion.py          # LFW dataset loading, splitting and manifest writing
│   ├── pairs.py              # pair generation and CSV genaration
│   └── similarity.py         # vectorized and loop cosine vs Euclidean
├── scripts/
│   ├── ingest_dataset.py         # download → split → manifest (uses functions in ingestion.py)
│   ├── create_pairs.py         # CLI: generate pair CSVs (uses functions in pairs.py)
│   └── benchmark.py           # CLI: loop vs. vectorized benchmark (uses functions in similarity.py)
├── tests/
│   └── test_similarity.py    # unit tests for similarity between cosine and euclidean , loop vs vectorized
├── notebooks/                # not used so far , for ipynb files 
├── data/                     # GITIGNORED — generated by ingest_dataset.py file, has the Dataset
└── outputs/                  # GITIGNORED — has the pairs , benchmark results , manifest , split and csv
```


## How to Run

### 1) virtual environment setup (venv)

**Windows (in powershell)**
py -m venv .venv
.\.venv\Scripts\Activate.ps1
pip install -r requirements.txt

**MAC**
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt

### to verify:

pip list

### 2) To ingest the LFW Dataset
``` python scripts/ingest_dataset.py --config configs/m1.yaml ```
            OR
```python3 scripts/ingest_dataset.py --config configs/m1.yaml ```

Outputs:
- "outputs/manifest.json" => seed, split policy, counts, data source used in this run
- "outputs/splits.json" => identity lists per split (train ,test and validate)
- "data/lfw_images/<name>/<idx>.jpg" => all the saved images

### 3) To create pairs 
python scripts/create_pairs.py --config configs/m1.yaml
            OR
python3 scripts/create_pairs.py --config configs/m1.yaml

Outputs:
- "outputs/pairs/train_pairs.csv"
- "outputs/pairs/val_pairs.csv"
- "outputs/pairs/test_pairs.csv"

Structure of each output CSV file (columns) => path_to_left_image , path_to_right_image , label , split

### 4) to run the benchmark file that compares euclidean and cosine:
python scripts/benchmark.py --config configs/m1.yaml
            OR
python3 scripts/benchmark.py --config configs/m1.yaml

Outputs:
- "outputs/bench/bench_results.json" => will have the time taken to run cosine and euclidean 

# 5) To run the tests 
python3 -m pytest tests/ -v 

# How to run this repo form scratch:
git clone https://github.com/rahulcs6104/msml605-face-ID.git
